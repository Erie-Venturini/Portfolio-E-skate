<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>E-Skate Project | Resultados de la Encuesta</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <aside class="sidebar sidebar-right">
    <a href="index.html#hero" class="sidebar-item" data-tooltip="Volver a Inicio"><i class="fas fa-home"></i></a>
    <a href="index.html#survey" class="sidebar-item" data-tooltip="Participa en la Encuesta"><i class="fas fa-poll-h"></i></a>
    <a href="resultados.html" class="sidebar-item" data-tooltip="Resultados"><i class="fas fa-chart-bar"></i></a>
    <a href="analisisCompetencia.html" class="sidebar-item" data-tooltip="Análisis de la Competencia"><i class="fas fa-balance-scale"></i></a>
  </aside>

  <header>
    <div class="container">
      <h1 class="logo-text">E-Skate Project</h1>
      <p class="tagline">Resultados de la Encuesta</p>
      <div class="menu-icon" id="mobileMenuToggle">
          <i class="fas fa-bars"></i>
      </div>
    </div>
  </header>

  <nav class="mobile-nav-overlay" id="mobileNavOverlay">
      <div class="mobile-nav-header"></div>
      <div class="mobile-nav-section">
          <h3 class="mobile-nav-category-title">Economía del Producto</h3>
          <ul class="mobile-nav-list">
              <li><a href="index.html#hero" class="mobile-nav-item"><i class="fas fa-home"></i> Volver a Inicio</a></li>
              <li><a href="index.html#survey" class="mobile-nav-item"><i class="fas fa-poll-h"></i> Participa en la Encuesta</a></li>
              <li><a href="resultados.html" class="mobile-nav-item"><i class="fas fa-chart-bar"></i> Resultados</a></li>
              <li><a href="analisisCompetencia.html" class="mobile-nav-item"><i class="fas fa-balance-scale"></i> Análisis de la Competencia</a></li>
          </ul>
      </div>
  </nav>

  <main>
    <section id="results-charts" class="section-padded content-section">
      <div class="container">
        <h2>Resultados Clave de Nuestra Encuesta</h2>
        <p class="description">Analizamos las respuestas de nuestra encuesta para comprender mejor las necesidades y preferencias de nuestros potenciales usuarios. Estos datos nos ayudan a moldear el futuro de E-Skate Project.</p>

        <div class="chart-grid">
          <div class="chart-card">
            <h3>Distribución Demográfica (Edad)</h3>
            <canvas id="ageChart"></canvas>
            <div class="small-text">
                <span style="color: #FFCC00;">■</span> 15-18 años
                <span style="color: #0F2D52;">■</span> 18-30 años
                <span style="color: #4CAF50;">■</span> 30+ años
            </div>
          </div>
          <div class="chart-card">
            <h3>Hábitos de Movilidad Actuales</h3>
            <canvas id="vehicleChart"></canvas>
            <div class="small-text">
                <span style="color: #FFCC00;">■</span> Automóvil propio
                <span style="color: #0F2D52;">■</span> Transporte público
                <span style="color: #4CAF50;">■</span> Bicicleta/Motocicleta
                <span style="color: #F44336;">■</span> Caminando
            </div>
          </div>
          <div class="chart-card">
            <h3>Interés en el Rastreo GPS</h3>
            <canvas id="gpsInterestChart"></canvas>
            <div class="small-text">
                <span style="color: #FFCC00;">■</span> Sí, me gustaría verlo
                <span style="color: #0F2D52;">■</span> No, no me gustaría
            </div>
          </div>
        </div>

        <div class="analysis-summary">
          <p class="description">El análisis de los datos demográficos revela una fuerte representación de usuarios jóvenes. La mayoría utiliza bicicleta o motocicleta, lo que indica una predisposición a soluciones de movilidad personal. Un alto porcentaje muestra interés en el rastreo GPS, confirmando la relevancia de esta característica para la seguridad y control del vehículo.</p>
          <p class="description">Además, la disposición a pagar por el producto muestra un mercado receptivo a la inversión en características de valor agregado como la seguridad y el monitoreo avanzado.</p>
        </div>

        <div class="button-group button-group-analysis">
          <a href="index.html#survey" class="btn-primary">Volver a la Encuesta</a>
          <a href="index.html" class="btn-primary">Volver a la Página Principal</a>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 E-Skate Project. Todos los derechos reservados.</p>
    </div>
  </footer>

  <script>
    // Navegación suave para todos los enlaces ancla
    document.querySelectorAll('a[href^="index.html#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            // Permitir la navegación si el hash no está en la misma página
            const targetHash = this.getAttribute('href').split('#')[1];
            if (window.location.pathname.endsWith('index.html') || window.location.pathname === '/') {
                // Si ya estamos en index.html, hacer scroll suave
                e.preventDefault();
                const targetElement = document.querySelector(`#${targetHash}`);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - (document.querySelector('header')?.offsetHeight || 0),
                        behavior: "smooth"
                    });
                }
            }
            // Si no estamos en index.html, el navegador manejará la navegación normal
        });
    });

    // Tooltip para el sidebar
    document.querySelectorAll('.sidebar-item').forEach(item => {
        const tooltipText = item.getAttribute('data-tooltip');
        if (tooltipText) {
            item.style.position = 'relative';
            item.addEventListener('mouseenter', function() {
                const tooltip = document.createElement('span');
                tooltip.classList.add('custom-tooltip');
                tooltip.textContent = tooltipText;
                this.appendChild(tooltip);
            });
            item.addEventListener('mouseleave', function() {
                const tooltip = this.querySelector('.custom-tooltip');
                if (tooltip) {
                    tooltip.remove();
                }
            });
        }
    });

    // Lógica para el menú hamburguesa (ahora con transformación de ícono y botón fijo)
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileNavOverlay = document.getElementById('mobileNavOverlay');

    if (mobileMenuToggle && mobileNavOverlay) {
        mobileMenuToggle.addEventListener('click', () => {
            const isMenuOpen = mobileNavOverlay.classList.contains('is-open');
            if (isMenuOpen) {
                // Si el menú está abierto, ciérralo
                mobileNavOverlay.classList.remove('is-open');
                document.body.classList.remove('menu-active');
                document.body.style.overflow = '';
                mobileMenuToggle.querySelector('i').classList.remove('fa-times');
                mobileMenuToggle.querySelector('i').classList.add('fa-bars');
            } else {
                // Si el menú está cerrado, ábrelo
                mobileNavOverlay.classList.add('is-open');
                document.body.classList.add('menu-active');
                document.body.style.overflow = 'hidden';
                mobileMenuToggle.querySelector('i').classList.remove('fa-bars');
                mobileMenuToggle.querySelector('i').classList.add('fa-times');
            }
        });
        
        // Cierra el menú si se hace clic en el backdrop (el área oscurecida)
        document.body.addEventListener('click', (e) => {
            // Si el menú está abierto y el clic no fue en el toggle ni dentro del overlay
            if (document.body.classList.contains('menu-active') && 
                !mobileNavOverlay.contains(e.target) && 
                !mobileMenuToggle.contains(e.target) &&
                !e.target.closest('.mobile-nav-overlay')) { // Añadido para asegurar que clics DENTRO del overlay no lo cierren
                
                mobileNavOverlay.classList.remove('is-open');
                document.body.classList.remove('menu-active');
                document.body.style.overflow = '';
                mobileMenuToggle.querySelector('i').classList.remove('fa-times');
                mobileMenuToggle.querySelector('i').classList.add('fa-bars');
            }
        });
    }

    // Asegurarse de que los enlaces del menú móvil también cierren el menú
    document.querySelectorAll('.mobile-nav-item').forEach(item => {
        item.addEventListener('click', () => {
            const mobileNavOverlay = document.getElementById('mobileNavOverlay');
            const mobileMenuToggle = document.getElementById('mobileMenuToggle'); 
            if (mobileNavOverlay && mobileMenuToggle) {
                mobileNavOverlay.classList.remove('is-open');
                document.body.classList.remove('menu-active'); 
                document.body.style.overflow = ''; 
                mobileMenuToggle.querySelector('i').classList.remove('fa-times'); 
                mobileMenuToggle.querySelector('i').classList.add('fa-bars');
            }
        });
    });

    // Datos de la encuesta (hardcodeados como ejemplo)
    const ageData = {
        '15-18 años': 4,
        'Entre 18 a 30 años': 4,
        '85': 1 
    };

    const vehicleData = {
        'Utilizo bicicleta o motocicleta': 7,
        'Tengo automóvil propio': 2,
        'Voy a todos lados caminando': 1
    };

    const gpsInterestData = {
        'Si': 9,
        'No': 0
    };

    // Procesar datos para los gráficos
    // Edad
    const ageLabels = ['15-18 años', '18-30 años', '30+ años'];
    const ageCounts = [ageData['15-18 años'], ageData['Entre 18 a 30 años'], ageData['85']];
    const ageColors = ['#FFCC00', '#0F2D52', '#4CAF50'];

    // Vehículo
    const vehicleLabels = ['Utilizo bicicleta o motocicleta', 'Tengo automóvil propio', 'Voy a todos lados caminando'];
    const vehicleCounts = [vehicleData['Utilizo bicicleta o motocicleta'], vehicleData['Tengo automóvil propio'], vehicleData['Voy a todos lados caminando']];
    const vehicleColors = ['#FFCC00', '#0F2D52', '#4CAF50', '#F44336']; 

    // Interés GPS
    const gpsLabels = ['Sí, me gustaría verlo', 'No, no me gustaría'];
    const gpsCounts = [gpsInterestData['Si'], gpsInterestData['No']];
    const gpsColors = ['#FFCC00', '#0F2D52'];

    // Función para crear gráficos de tipo Doughnut
    function createDoughnutChart(ctx, labels, data, colors, title) {
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: colors,
            hoverOffset: 10
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false, 
          plugins: {
            legend: {
              display: false 
            },
            title: {
              display: false 
            },
            tooltip: {
                callbacks: {
                    label: function(context) {
                        let label = context.label || '';
                        if (label) {
                            label += ': ';
                        }
                        if (context.parsed !== null) {
                            label += context.parsed;
                        }
                        return label;
                    }
                }
            }
          }
        }
      });
    }

    // Renderizar gráficos
    document.addEventListener('DOMContentLoaded', () => {
      const ageCtx = document.getElementById('ageChart').getContext('2d');
      createDoughnutChart(ageCtx, ageLabels, ageCounts, ageColors, 'Distribución Demográfica (Edad)');

      const vehicleCtx = document.getElementById('vehicleChart').getContext('2d');
      createDoughnutChart(vehicleCtx, vehicleLabels, vehicleCounts, vehicleColors, 'Hábitos de Movilidad Actuales');

      const gpsInterestCtx = document.getElementById('gpsInterestChart').getContext('2d');
      createDoughnutChart(gpsInterestCtx, gpsLabels, gpsCounts, gpsColors, 'Interés en el Rastreo GPS');
    });
  </script>
</body>
</html>