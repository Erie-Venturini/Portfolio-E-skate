<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>E-Skate Project | Innovación en Movilidad Urbana</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>
  <aside class="sidebar sidebar-left">
    <a href="#hero" class="sidebar-item" data-tooltip="Inicio"><i class="fas fa-home"></i></a>
    <a href="#about" class="sidebar-item" data-tooltip="Visión del Proyecto"><i class="fas fa-lightbulb"></i></a>
    <a href="#product-showcase" class="sidebar-item" data-tooltip="Explora el Producto"><i class="fas fa-cube"></i></a>
    <a href="#features" class="sidebar-item" data-tooltip="Características Clave"><i class="fas fa-cogs"></i></a>
    <a href="#contact" class="sidebar-item" data-tooltip="Contáctanos"><i class="fas fa-envelope"></i></a>
  </aside>

  <aside class="sidebar sidebar-right">
    <a href="#survey" class="sidebar-item" data-tooltip="Participa en la Encuesta"><i class="fas fa-poll-h"></i></a>
    <a href="resultados.html" class="sidebar-item" data-tooltip="Resultados"><i class="fas fa-chart-bar"></i></a>
    <a href="analisisCompetencia.html" class="sidebar-item" data-tooltip="Análisis de la Competencia"><i class="fas fa-balance-scale"></i></a>
  </aside>

  <header>
    <div class="container">
      <h1 class="logo-text">E-Skate Project</h1>
      <p class="tagline">Innovación y Futuro en Movilidad Urbana</p>
      <div class="menu-icon" id="mobileMenuToggle">
          <i class="fas fa-bars"></i>
      </div>
    </div>
  </header>

  <nav class="mobile-nav-overlay" id="mobileNavOverlay">
      <div class="mobile-nav-header"></div>
      <div class="mobile-nav-section">
          <h3 class="mobile-nav-category-title">Página Principal</h3>
          <ul class="mobile-nav-list">
              <li><a href="#hero" class="mobile-nav-item"><i class="fas fa-home"></i> Inicio</a></li>
              <li><a href="#about" class="mobile-nav-item"><i class="fas fa-lightbulb"></i> Visión del Proyecto</a></li>
              <li><a href="#product-showcase" class="mobile-nav-item"><i class="fas fa-cube"></i> Explora el Producto</a></li>
              <li><a href="#features" class="mobile-nav-item"><i class="fas fa-cogs"></i> Características Clave</a></li>
              <li><a href="#contact" class="mobile-nav-item"><i class="fas fa-envelope"></i> Contáctanos</a></li>
          </ul>
      </div>
      <div class="mobile-nav-section">
          <h3 class="mobile-nav-category-title">Economía del Producto</h3>
          <ul class="mobile-nav-list">
              <li><a href="#survey" class="mobile-nav-item"><i class="fas fa-poll-h"></i> Participa en la Encuesta</a></li>
              <li><a href="resultados.html" class="mobile-nav-item"><i class="fas fa-chart-bar"></i> Resultados</a></li>
              <li><a href="analisisCompetencia.html" class="mobile-nav-item"><i class="fas fa-balance-scale"></i> Análisis de la Competencia</a></li>
          </ul>
      </div>
  </nav>

  <main>
    <section id="hero" class="hero-section">
      <div class="container">
        <div class="hero-content">
          <h2>Transformando el Viaje Urbano</h2>
          <p class="hero-description">Nuestro sistema de seguimiento y control redefine la experiencia del skate eléctrico, ofreciendo seguridad, eficiencia y una conexión sin precedentes.</p>
          <a href="http://eskate.onrender.com" class="btn-primary hero-btn">Conocer Nuestra Página</a>
        </div>
      </div>
    </section>

    <section id="about" class="section-padded content-section">
      <div class="container">
        <h2>Nuestra Visión: Movilidad Inteligente</h2>
        <div class="about-grid">
          <div class="about-text">
            <p>
              En E-Skate Project, nos dedicamos a la fusión de tecnología y transporte personal. Nuestro objetivo es crear un ecosistema donde los vehículos como los skates eléctricos no solo sean rápidos y divertidos, sino también seguros e inteligentes.
            </p>
            <p>
              Esta iniciativa surge de la necesidad de comprender cómo un sistema de rastreo GPS, control remoto y análisis de datos puede impactar positivamente la experiencia del usuario y abordar preocupaciones clave como el robo y la optimización del rendimiento. Creemos en un futuro donde cada viaje es una experiencia conectada y protegida.
            </p>
          </div>
          <div class="about-image">
            <img src="https://billiken.lat/wp-content/uploads/2023/11/DESTACADA-BILLIKEN-9-1.png" alt="Persona usando un skate eléctrico" class="responsive-img">
          </div>
        </div>
      </div>
    </section>

    <section id="product-showcase" class="section-padded accent-bg">
      <div class="container text-center">
        <h2>Explora Nuestro Concepto en 3D</h2>
        <p class="description">Gira, haz zoom y descubre cada detalle de nuestros prototipos. Una visión interactiva del futuro.</p>

        <div class="model-viewer-container">
          <model-viewer
            id="mainModelViewer" 
            src="animacionAbertura.glb" 
            alt="Modelo 3D interactivo"
            camera-controls
            shadow-intensity="1"
            ar
            ar-modes="webxr quick-look scene-viewer"
            seamless-poster
            environment-image="neutral"
            exposure="1"
            interaction-prompt="none"
            class="interactive-model"
            
            camera-orbit="0deg 80deg 2.8m" 
            camera-target="0.0m 0.6m 0.0m" 
            field-of-view="35deg" >
            <button slot="poster" class="loading-spinner"></button>
          </model-viewer>
        </div>

        <div class="model-controls">
            <button class="btn-primary model-toggle-btn" 
                    data-model-src="animacionAbertura.glb" 
                    data-animation-name="AperturaCompletaYSalida"
                    data-camera-orbit="0deg 80deg 2.8m" 
                    data-camera-target="0.0m 0.6m 0.0m" 
                    data-field-of-view="35deg">Abrir Caja y Sacar Skate</button>
            
            <button class="btn-primary model-toggle-btn" 
                    data-model-src="vistaComponentes.glb" 
                    data-animation-name="VistaComponentesAnim"
                    data-camera-orbit="0deg 75deg 4.5m"  data-camera-target="0.0m 1.0m 0.0m" data-field-of-view="55deg">Desglosar Componentes</button> <button class="btn-primary model-reset-btn">Reiniciar Vista Actual</button>
        </div>

      </div>
    </section>

    <section id="features" class="section-padded content-section">
      <div class="container">
        <h2>Características que Impulsan el Futuro</h2>
        <div class="features-grid">
          <div class="feature-card">
            <i class="fas fa-map-marker-alt"></i>
            <h3>Rastreo GPS en Tiempo Real</h3>
            <p>Monitorea la ubicación exacta de tu skate desde cualquier lugar, con actualizaciones instantáneas y geocercas personalizables.</p>
          </div>
          <div class="feature-card">
            <i class="fas fa-lock"></i>
            <h3>Bloqueo Remoto Inteligente</h3>
            <p>Asegura tu vehículo con un toque. Bloquea las ruedas remotamente para disuadir robos o recuperarlo más fácilmente.</p>
          </div>
          <div class="feature-card">
            <i class="fas fa-chart-line"></i>
            <h3>Análisis de Rendimiento</h3>
            <p>Accede a estadísticas de tus viajes: distancia, velocidad promedio, rutas y consumo de batería para optimizar tu experiencia.</p>
          </div>
          <div class="feature-card">
            <i class="fas fa-bell"></i>
            <h3>Alertas de Seguridad Instantáneas</h3>
            <p>Recibe notificaciones en tu móvil si tu skate se mueve inesperadamente o sale de una zona segura predefinida.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="survey" class="section-padded accent-bg">
      <div class="container text-center">
        <h2>Tu Voz Impulsa la Innovación</h2>
        <p class="description">Tu opinión es fundamental para dar forma al futuro de la movilidad inteligente. Ayúdanos a construir la solución perfecta.</p>

        <div class="button-group">
          <button id="toggleFormBtn" class="btn-primary">Cerrar Encuesta</button>
          <a href="resultados.html" class="btn-primary">Ver Análisis de Resultados</a>
        </div>

        <div id="formContainer" class="form-embed-wrapper">
          <iframe
            src="https://docs.google.com/forms/d/e/1FAIpQLSc1aDMNoK8InEa-Y-MXDXiM-DX-NnrUMotyScSR15nSBSJb1Q/viewform?embedded=true"
            width="100%"
            height="700"
            frameborder="0"
            marginheight="0"
            marginwidth="0">
            Cargando…
          </iframe>
        </div>
      </div>
    </section>

    <section id="contact" class="section-padded content-section">
        <div class="container">
            <h2>Hablemos de Futuro</h2>
            <p class="description">¿Interesado en saber más o colaborar? Contáctanos para explorar las posibilidades.</p>
            <div class="contact-info-grid">
                <div class="contact-detail">
                    <i class="fas fa-map-marker-alt"></i>
                    <p>Córdoba, Argentina</p>
                </div>
                <div class="contact-detail">
                    <i class="fas fa-envelope"></i>
                    <p><a href="mailto:eskatevz@gmail.com">eskatevz@gmail.com</a></p>
                </div>
                <div class="contact-detail">
                    <i class="fas fa-phone"></i>
                    <p><a href="tel:+5493571419879">+54 3571 419879</a></p>
                </div>
            </div>
            <div class="social-icons-contact">
                <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="#" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                <a href="#" target="_blank" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 E-Skate Project. Todos los derechos reservados.</p>
    </div>
  </footer>

  <script>
    // Toggle para el formulario de la encuesta
    const toggleBtn = document.getElementById('toggleFormBtn');
    const formContainer = document.getElementById('formContainer');

    // Estado inicial: Encuesta visible, botón dice "Cerrar Encuesta"
    if (formContainer && toggleBtn) {
        formContainer.style.display = 'block';
        toggleBtn.textContent = 'Cerrar Encuesta';

        toggleBtn.addEventListener('click', () => {
            const isVisible = formContainer.style.display !== 'none';
            formContainer.style.display = isVisible ? 'none' : 'block';
            toggleBtn.textContent = isVisible ? 'Abrir Encuesta' : 'Cerrar Encuesta';
        });
    }

    // Navegación suave para todos los enlaces ancla y externos
    document.querySelectorAll('a[href^="#"], a[href="resultados.html"], a[href="analisisCompetencia.html"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            const href = this.getAttribute('href');
            
            if (href.startsWith('#')) {
                e.preventDefault(); 
                const targetId = href;
                const targetElement = document.querySelector(targetId);

                if (this.classList.contains('mobile-nav-item')) {
                    const mobileNavOverlay = document.getElementById('mobileNavOverlay');
                    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
                    if (mobileNavOverlay && mobileMenuToggle) {
                        mobileNavOverlay.classList.remove('is-open');
                        document.body.classList.remove('menu-active');
                        document.body.style.overflow = '';
                        mobileMenuToggle.querySelector('i').classList.remove('fa-times');
                        mobileMenuToggle.querySelector('i').classList.add('fa-bars');
                    }
                }

                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - (document.querySelector('header')?.offsetHeight || 0),
                        behavior: "smooth"
                    });
                }
            } else {
                if (this.classList.contains('mobile-nav-item')) {
                    const mobileNavOverlay = document.getElementById('mobileNavOverlay');
                    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
                    if (mobileNavOverlay && mobileMenuToggle) {
                        mobileNavOverlay.classList.remove('is-open');
                        document.body.classList.remove('menu-active');
                        document.body.style.overflow = '';
                        mobileMenuToggle.querySelector('i').classList.remove('fa-times');
                        mobileMenuToggle.querySelector('i').classList.add('fa-bars');
                    }
                }
            }
        });
    });

    // Tooltip para el sidebar
    document.querySelectorAll('.sidebar-item').forEach(item => {
        const tooltipText = item.getAttribute('data-tooltip');
        if (tooltipText) {
            item.style.position = 'relative';
            item.addEventListener('mouseenter', function() {
                const tooltip = document.createElement('span');
                tooltip.classList.add('custom-tooltip');
                tooltip.textContent = tooltipText;
                this.appendChild(tooltip);
            });
            item.addEventListener('mouseleave', function() {
                const tooltip = this.querySelector('.custom-tooltip');
                if (tooltip) {
                    tooltip.remove();
                }
            });
        }
    });

    // Lógica para el menú hamburguesa
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileNavOverlay = document.getElementById('mobileNavOverlay');

    if (mobileMenuToggle && mobileNavOverlay) {
        mobileMenuToggle.addEventListener('click', () => {
            const isMenuOpen = mobileNavOverlay.classList.contains('is-open');
            if (isMenuOpen) {
                mobileNavOverlay.classList.remove('is-open');
                document.body.classList.remove('menu-active');
                document.body.style.overflow = '';
                mobileMenuToggle.querySelector('i').classList.remove('fa-times');
                mobileMenuToggle.querySelector('i').classList.add('fa-bars');
            } else {
                mobileNavOverlay.classList.add('is-open');
                document.body.classList.add('menu-active');
                document.body.style.overflow = 'hidden';
                mobileMenuToggle.querySelector('i').classList.remove('fa-bars');
                mobileMenuToggle.querySelector('i').classList.add('fa-times');
            }
        });
        
        document.body.addEventListener('click', (e) => {
            if (document.body.classList.contains('menu-active') && 
                !mobileNavOverlay.contains(e.target) && 
                !mobileMenuToggle.contains(e.target)) {
                
                mobileNavOverlay.classList.remove('is-open');
                document.body.classList.remove('menu-active');
                document.body.style.overflow = '';
                mobileMenuToggle.querySelector('i').classList.remove('fa-times');
                mobileMenuToggle.querySelector('i').classList.add('fa-bars');
            }
        });
    }

    // --- CÓDIGO PARA CONTROLAR EL ÚNICO MODEL-VIEWER ---
    const mainModelViewer = document.getElementById('mainModelViewer');

    // Estado para guardar las configuraciones de cada modelo
    const modelConfigs = {
        "animacionAbertura.glb": {
            animation: "AperturaCompletaYSalida",
            cameraOrbit: "0deg 80deg 2.8m", 
            cameraTarget: "0.0m 0.6m 0.0m", 
            fieldOfView: "35deg" 
        },
        "vistaComponentes.glb": {
            animation: "VistaComponentesAnim", 
            // Nuevos valores para "Desglosar Componentes":
            // Elevación del objetivo a 1.0m y mayor distancia (4.5m)
            cameraOrbit: "0deg 75deg 4.5m", 
            cameraTarget: "0.0m 1.0m 0.0m", 
            fieldOfView: "55deg" 
        }
    };

    // Función para aplicar la configuración de la cámara al model-viewer
    const applyCameraConfig = (viewer, config) => {
        if (config.cameraOrbit) viewer.cameraOrbit = config.cameraOrbit;
        if (config.cameraTarget) viewer.cameraTarget = config.cameraTarget; 
        if (config.fieldOfView) viewer.fieldOfView = config.fieldOfView;
    };

    if (mainModelViewer) {
      mainModelViewer.addEventListener('load', () => {
        console.log('Modelo principal cargado correctamente:', mainModelViewer.src);
        
        mainModelViewer.autoplay = false; 
        mainModelViewer.animationName = ''; 
        mainModelViewer.autoRotate = false; 
        mainModelViewer.cameraControls = true; 

        console.log('Animaciones disponibles en el modelo actual:', mainModelViewer.availableAnimations);
        
        // Al cargar, aplicar la configuración de la cámara para el GLB inicial
        const initialSrc = mainModelViewer.src.split('/').pop(); 
        if (modelConfigs[initialSrc]) {
            applyCameraConfig(mainModelViewer, modelConfigs[initialSrc]);
        }
      });

      mainModelViewer.addEventListener('error', (event) => {
        console.error('Error al cargar el modelo 3D:', event);
      });
    }

    // Botones para alternar modelos y reproducir animaciones
    const modelToggleButtons = document.querySelectorAll('.model-toggle-btn');
    const modelResetButton = document.querySelector('.model-reset-btn');

    if (mainModelViewer && modelToggleButtons.length > 0) {
        modelToggleButtons.forEach(button => {
            button.addEventListener('click', async () => {
                const newModelSrc = button.dataset.modelSrc;
                const animName = button.dataset.animationName;
                const cameraOrbit = button.dataset.cameraOrbit;
                const cameraTarget = button.dataset.cameraTarget; 
                const fieldOfView = button.dataset.fieldOfView;

                // Si el modelo ya está cargado y es el mismo, solo reiniciamos y reproducimos la animación
                if (mainModelViewer.src.endsWith(newModelSrc)) {
                    console.log(`Modelo ${newModelSrc} ya cargado. Reiniciando y reproduciendo animación.`);
                    mainModelViewer.pause();
                    mainModelViewer.currentTime = 0; // Asegura que empiece desde el inicio
                    mainModelViewer.animationName = animName;
                    const playback = mainModelViewer.play({ repetition: 1 }); // Reproduce una vez

                    // Usa la promesa de reproducción para saber cuándo termina la animación
                    playback.then(() => {
                        mainModelViewer.pause(); // Pausa explícitamente al final para que se quede en el último frame
                    }).catch((error) => {
                        // Manejar si la promesa es rechazada (ej. si la animación se detiene manualmente)
                        console.error('Error o interrupción de la animación:', error);
                    });

                    applyCameraConfig(mainModelViewer, { cameraOrbit, cameraTarget, fieldOfView }); 
                } else {
                    // Si es un modelo diferente, lo cambiamos y esperamos que cargue
                    console.log(`Cambiando modelo a: ${newModelSrc}`);
                    mainModelViewer.pause();
                    mainModelViewer.animationName = ''; 
                    mainModelViewer.autoRotate = false; 
                    mainModelViewer.src = newModelSrc; 

                    // Espera a que el nuevo modelo cargue completamente
                    await mainModelViewer.updateComplete; 
                    
                    console.log(`Nuevo modelo ${newModelSrc} cargado. Animaciones disponibles:`, mainModelViewer.availableAnimations);

                    // Una vez cargado, reproducir la animación deseada y aplicar config de cámara
                    if (mainModelViewer.availableAnimations.includes(animName)) {
                        console.log(`Reproduciendo animación: ${animName}`);
                        mainModelViewer.animationName = animName;
                        mainModelViewer.currentTime = 0; 
                        const playback = mainModelViewer.play({ repetition: 1 }); // Reproduce una vez

                        playback.then(() => {
                            mainModelViewer.pause(); // Pausa explícitamente al final
                        }).catch((error) => {
                            console.error('Error o interrupción de la animación:', error);
                        });
                        applyCameraConfig(mainModelViewer, { cameraOrbit, cameraTarget, fieldOfView }); 
                    } else {
                        console.warn(`Animación '${animName}' no encontrada en el modelo ${newModelSrc}.`);
                        mainModelViewer.animationName = ''; 
                        applyCameraConfig(mainModelViewer, { cameraOrbit, cameraTarget, fieldOfView }); 
                    }
                }
            });
        });
    }

    // Botón para reiniciar la vista del modelo actual
    if (modelResetButton) {
        modelResetButton.addEventListener('click', () => {
            mainModelViewer.pause();
            mainModelViewer.currentTime = 0;
            mainModelViewer.animationName = '';
            mainModelViewer.autoRotate = false; 

            // Obtener la configuración de cámara del modelo actual
            const currentSrc = mainModelViewer.src.split('/').pop();
            if (modelConfigs[currentSrc]) {
                applyCameraConfig(mainModelViewer, modelConfigs[currentSrc]);
            } else {
                mainModelViewer.cameraOrbit = '0deg 75deg auto'; 
                mainModelViewer.cameraTarget = 'auto auto auto'; 
                mainModelViewer.fieldOfView = 'auto';
            }
            console.log(`Vista del modelo ${currentSrc} reiniciada a su estado inicial.`);
        });
    }
  </script>
</body>
</html>